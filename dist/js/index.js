(()=>{"use strict";var __webpack_modules__={"./src/js/classes/TypingLogic.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (/* binding */ TypingLogic)\n/* harmony export */ });\n/* harmony import */ var _helpers_keys__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/keys */ "./src/js/helpers/keys.js");\n\r\n\r\nclass TypingLogic {\r\n    constructor(text = "Hello, world!\\nHi, world!\\nYeah, world!") {\r\n        this.listText = document.querySelector(".typing-workspace__list-lines");\r\n        this.listKeys = document.querySelector(".keyboard__keys");\r\n        this.btnRepeat = document.querySelector(".typing-workspace__progress-repeat");\r\n        this.progressLine = document.querySelector(".typing-workspace__progress-line-inner");\r\n        this.countCompletedLinesEl = document.querySelector(".typing-workspace__progress-completed");\r\n        this.end = false;\r\n        this.text = text;\r\n        this.textData = [];\r\n        this.ignoreKeys = ["Tab", "CapsLock", "ShiftLeft", "ShiftRight", "ControlLeft", "ControlRight", "MetaLeft", "MetaRight", "AltLeft", "AltRight", "ContextMenu"];\r\n    }\r\n\r\n    _renderCountCompletedLines() {\r\n        const countCompletedTexts = this.textData.filter(({ completed, }) => completed).length;\r\n\r\n        this.countCompletedLinesEl.textContent = `${countCompletedTexts}/${this.textData.length}`;\r\n    }\r\n\r\n    _renderKeys() {\r\n        _helpers_keys__WEBPACK_IMPORTED_MODULE_0__["default"].forEach((rowArr) => {\r\n            const rowKeys = document.createElement("div");\r\n            \r\n            rowKeys.classList.add("keyboard__row-keys");\r\n\r\n            rowArr.forEach(({ className, str, key, }) => {\r\n                const keyBlock = document.createElement("div");\r\n\r\n                keyBlock.classList.add("key", className || "key--empty");\r\n\r\n                keyBlock.textContent = str;\r\n                keyBlock.dataset.key = key;\r\n\r\n                rowKeys.appendChild(keyBlock);\r\n            });\r\n\r\n            this.listKeys.appendChild(rowKeys);\r\n        });\r\n    }\r\n\r\n    _renderText() {\r\n        this.listText.innerHTML = "";\r\n        \r\n        this.textData.forEach(({ sentence, }, idx) => {\r\n            const HTMLLineStr = `\r\n                <li class="typing-workspace__line" data-line-idx="${idx}">\r\n                    <p class="typing-workspace__line-text text-keys">\r\n                        <span class="key--completed"></span>\r\n                        <span class="typing-workspace__line-text-not-completed">${sentence}</span>\r\n                    </p>\r\n                    <span class="typing-workspace__line-text-num">${idx + 1}</span>\r\n                </li>\r\n            `;\r\n\r\n            this.listText.innerHTML += HTMLLineStr;\r\n        });\r\n    }\r\n\r\n    _fillTextData() {\r\n        this.textData = this\r\n            .text\r\n            .split("\\n")\r\n            .reduce((acc, sentence, idx) => {\r\n                const letters = sentence\r\n                    .split("")\r\n                    .map((letter, idx) => ({ letter, active: idx === 0, completed: false, }));\r\n\r\n                acc.push({\r\n                    letters,\r\n                    sentence,\r\n                    active: idx === 0,\r\n                    completed: false,\r\n                });\r\n                \r\n                return acc;\r\n            }, []);\r\n    }\r\n\r\n    _setPressedKey(els, idx) {\r\n        els.forEach((el) => el.classList.remove("key--pressed"));\r\n\r\n        els[idx].classList.add("key--pressed");\r\n    }\r\n\r\n    _setProgress() {\r\n        const completedLines = this.textData.filter(({ completed, }) => completed).length;\r\n        const allLines = this.textData.length;\r\n        const progress = Math.ceil((completedLines / allLines) * 100);\r\n\r\n        this.progressLine.style.width = `${progress}%`;\r\n    }\r\n\r\n    _setRepeat() {\r\n        this.btnRepeat.addEventListener("click", () => {\r\n            this.textData.forEach((sentence, idx) => {\r\n                sentence.active = idx === 0;\r\n                sentence.completed = false;\r\n                sentence.letters.forEach((letter, index) => {\r\n                    letter.active = index === 0;\r\n                    letter.completed = false;\r\n                });\r\n            });\r\n\r\n            this.end = false;\r\n\r\n            this._setProgress();\r\n            this._renderCountCompletedLines();\r\n            this._renderText();\r\n        });\r\n    }\r\n\r\n    _checkTyping(pressedKey) {\r\n        const findActiveIdxSentence = this.textData.findIndex(({ active, }) => active);\r\n        const sentenceData = this.textData[findActiveIdxSentence];\r\n        const findActiveIdxKey = sentenceData.letters.findIndex(({ active, }) => active);\r\n        const findKey = sentenceData.letters[findActiveIdxKey].letter;\r\n\r\n        if (this.ignoreKeys.includes(pressedKey)) {\r\n            return;\r\n        }\r\n        \r\n        // TODO:\r\n        // * Конец попытки на текущем предложении\r\n        //   начинаем заново (только это предложение)\r\n        if (findKey !== pressedKey) {\r\n            return;\r\n        }\r\n\r\n        // Отключаем текущую активную букву\r\n        this.textData[findActiveIdxSentence].letters[findActiveIdxKey].completed = true;\r\n        this.textData[findActiveIdxSentence].letters[findActiveIdxKey].active = false;\r\n\r\n        if (findActiveIdxKey + 1 < this.textData[findActiveIdxSentence].letters.length) {\r\n            // Включаем следующую активную букву\r\n            this.textData[findActiveIdxSentence].letters[findActiveIdxKey + 1].active = true;\r\n        } else {\r\n            // Отключаем текущее активное предложение\r\n            this.textData[findActiveIdxSentence].active = false;\r\n            this.textData[findActiveIdxSentence].completed = true;\r\n\r\n            if (findActiveIdxSentence + 1 < Object.keys(this.textData).length) {\r\n                // Включаем следующее активное предложение и букву\r\n                this.textData[findActiveIdxSentence + 1].active = true;\r\n                this.textData[findActiveIdxSentence + 1].letters[0].active = true;\r\n            } else {\r\n                console.log("finish");\r\n    \r\n                this.end = true;\r\n            }\r\n        }\r\n\r\n        this._setProgress();\r\n        this._renderCountCompletedLines();\r\n        this._splitSentenceInHTML(findActiveIdxSentence, sentenceData);\r\n    }\r\n\r\n    _splitSentenceInHTML(idxLine, sentenceData) {\r\n        const elLine = document.querySelector(`.typing-workspace__line[data-line-idx="${idxLine}"]`);\r\n        const completedKeysEl = elLine.querySelector(".key--completed");\r\n        const notCompletedKeysEl = elLine.querySelector(".typing-workspace__line-text-not-completed");\r\n        const completedLetters = sentenceData.letters.filter(({ completed, }) => completed);\r\n        const notCompletedLetters = sentenceData.letters.filter(({ completed, }) => !completed);\r\n\r\n        completedKeysEl.textContent = completedLetters.reduce((str, { letter, }) => str += letter, "");\r\n        notCompletedKeysEl.textContent = notCompletedLetters.reduce((str, { letter, }) => str += letter, "");\r\n    }\r\n\r\n    _typing() {\r\n        const keyEls = document.querySelectorAll(".key[data-key]");\r\n\r\n        window.addEventListener("keydown", (e) => {\r\n            e.preventDefault();\r\n\r\n            if (this.end) {\r\n                return;\r\n            }\r\n\r\n            const code = e.code;\r\n            const key = e.key;\r\n            const findMatchIdx = [...keyEls].findIndex((el) => el.dataset.key === code);\r\n            \r\n            if (findMatchIdx === -1) {\r\n                return;\r\n            }\r\n            \r\n            this._setPressedKey(keyEls, findMatchIdx);\r\n            this._checkTyping(key);\r\n        });\r\n    }\r\n\r\n    init() {\r\n        this._fillTextData();\r\n        this._renderText();\r\n        this._renderKeys();\r\n        this._renderCountCompletedLines();\r\n        this._typing();\r\n        this._setRepeat();\r\n    }\r\n}\n\n//# sourceURL=webpack://typing_app/./src/js/classes/TypingLogic.js?')},"./src/js/helpers/keys.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ([\r\n    [\r\n        { key: "Backquote", str: "`", className: "finger1", },\r\n        { key: "Digit1", str: "1", className: "finger1", },\r\n        { key: "Digit2", str: "2", className: "finger2", },\r\n        { key: "Digit3", str: "3", className: "finger3", },\r\n        { key: "Digit4", str: "4", className: "finger4", },\r\n        { key: "Digit5", str: "5", className: "finger4", },\r\n        { key: "Digit6", str: "6", className: "finger4", },\r\n        { key: "Digit7", str: "7", className: "finger5", },\r\n        { key: "Digit8", str: "8", className: "finger3", },\r\n        { key: "Digit9", str: "9", className: "finger2", },\r\n        { key: "Digit0", str: "0", className: "finger1", },\r\n        { key: "Minus", str: "-", className: "finger1", },\r\n        { key: "Equal", str: "=", className: "finger1", },\r\n        { key: "Backspace", str: "Backsp", className: "", },\r\n    ],\r\n    [\r\n        { key: "Tab", str: "Tab", className: "", },\r\n        { key: "KeyQ", str: "q", className: "finger1", },\r\n        { key: "KeyW", str: "w", className: "finger2", },\r\n        { key: "KeyE", str: "e", className: "finger3", },\r\n        { key: "KeyR", str: "r", className: "finger4", },\r\n        { key: "KeyT", str: "t", className: "finger4", },\r\n        { key: "KeyY", str: "y", className: "finger5", },\r\n        { key: "KeyU", str: "u", className: "finger5", },\r\n        { key: "KeyI", str: "i", className: "finger3", },\r\n        { key: "KeyO", str: "o", className: "finger2", },\r\n        { key: "KeyP", str: "p", className: "finger1", },\r\n        { key: "BracketLeft", str: "[", className: "finger1", },\r\n        { key: "BracketRight", str: "]", className: "finger1", },\r\n        { key: "Backslash", str: "\\\\", className: "finger1", },\r\n    ],\r\n    [\r\n        { key: "CapsLock", str: "Caps Lock", className: "", },\r\n        { key: "KeyA", str: "a", className: "finger1", },\r\n        { key: "KeyS", str: "s", className: "finger2", },\r\n        { key: "KeyD", str: "d", className: "finger3", },\r\n        { key: "KeyF", str: "f", className: "finger4", },\r\n        { key: "KeyG", str: "g", className: "finger4", },\r\n        { key: "KeyH", str: "h", className: "finger5", },\r\n        { key: "KeyJ", str: "j", className: "finger5", },\r\n        { key: "KeyK", str: "k", className: "finger3", },\r\n        { key: "KeyL", str: "l", className: "finger2", },\r\n        { key: "Semicolon", str: ";", className: "finger1", },\r\n        { key: "Quote", str: "\'", className: "finger1", },\r\n        { key: "Enter", str: "Enter", className: "", },\r\n    ],\r\n    [\r\n        { key: "ShiftLeft", str: "Shift", className: "", },\r\n        { key: "KeyZ", str: "z", className: "finger1", },\r\n        { key: "KeyX", str: "x", className: "finger2", },\r\n        { key: "KeyC", str: "c", className: "finger3", },\r\n        { key: "KeyV", str: "v", className: "finger4", },\r\n        { key: "KeyB", str: "b", className: "finger4", },\r\n        { key: "KeyN", str: "n", className: "finger5", },\r\n        { key: "KeyM", str: "m", className: "finger5", },\r\n        { key: "Comma", str: ",", className: "finger3", },\r\n        { key: "Period", str: ".", className: "finger2", },\r\n        { key: "Slash", str: "/", className: "finger1", },\r\n        { key: "ShiftRight", str: "Shift", className: "", },\r\n    ],\r\n    [\r\n        { key: "ControlLeft", str: "Ctrl", className: "", },\r\n        { key: "MetaLeft", str: "Win", className: "", },\r\n        { key: "AltLeft", str: "Alt", className: "", },\r\n        { key: "Space", str: "", className: "finger6", },\r\n        { key: "AltRight", str: "Alt", className: "", },\r\n        { key: "MetaRight", str: "Win", className: "", },\r\n        { key: "ContextMenu", str: "Ctx Menu", className: "", },\r\n        { key: "ControlRight", str: "Ctrl", className: "", },\r\n    ],\r\n]);\n\n//# sourceURL=webpack://typing_app/./src/js/helpers/keys.js?')},"./src/js/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _classes_TypingLogic__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./classes/TypingLogic */ "./src/js/classes/TypingLogic.js");\n\r\n\r\nnew _classes_TypingLogic__WEBPACK_IMPORTED_MODULE_0__["default"]().init();\n\n//# sourceURL=webpack://typing_app/./src/js/index.js?')}},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];return void 0!==r||(r=__webpack_module_cache__[e]={exports:{}},__webpack_modules__[e](r,r.exports,__webpack_require__)),r.exports}__webpack_require__.d=(e,r)=>{for(var n in r)__webpack_require__.o(r,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},__webpack_require__.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/js/index.js")})();